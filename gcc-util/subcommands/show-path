#!/bin/sh

set -e

usage() {
  cat <<EOF
Usage: $(basename "$0") <binary>

Print the absolute path to an installed binary.

Arguments:
  binary  Name of the binary (e.g., gcc, g++, cc1)

Options:
  -h, --help  Show this help message

Example:
  $(basename "$0") gcc  # Prints /path/to/gcc/install/bin/gcc
EOF
}

if [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
  usage
  exit 0
fi

if [ -z "$1" ]; then
  >&2 echo "Error: Missing required argument: binary"
  >&2 echo
  usage >&2
  exit 1
fi

"$GCC_UTIL_ROOT/subcommands/build" 1>&2

if [ -f "$GCC_INSTALL_DIR/bin/$1" ]; then
  realpath "$GCC_INSTALL_DIR/bin/$1"
elif [ -f "$GCC_INSTALL_DIR/libexec/gcc/x86_64-pc-linux-gnu/$1" ]; then
  realpath "$GCC_INSTALL_DIR/libexec/gcc/x86_64-pc-linux-gnu/$1"
elif [ -f "$GCC_INSTALL_DIR/libexec/gcc/x86_64-linux-gnu/$1" ]; then
  realpath "$GCC_INSTALL_DIR/libexec/gcc/x86_64-linux-gnu/$1"
else
  >&2 echo "Error: Binary '$1' not found in install directory"
  exit 1
fi
