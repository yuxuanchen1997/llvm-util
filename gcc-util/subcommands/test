#!/bin/sh

set -e

usage() {
  cat <<EOF
Usage: $(basename "$0") <test-paths...>

Run GCC tests using dejagnu (runtest).

Arguments:
  test-paths  Paths to test files or directories

Options:
  -h, --help  Show this help message

Examples:
  $(basename "$0") gcc.c-torture/execute
  $(basename "$0") gcc.dg/test.c
EOF
}

if [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
  usage
  exit 0
fi

if [ -z "$1" ]; then
  >&2 echo "Error: Missing required argument: test-paths"
  >&2 echo
  usage >&2
  exit 1
fi

cd "$GCC_PROJECT_ROOT/build"
make check RUNTESTFLAGS="$@"
